
Для улучшения читабельности кода были добавлены комментарии и были изменены названия переменных, чтобы было понятно, что они значат:
h -> length -- Длина отверстия
w -> width -- Ширина отверстия
test -> obstacle -- Название матрицы отверстия
test_sys -> Screen -- Название матрицы конечной картины, которю отрисовываем
Переменные в конструкторе теперь инициализируются по-человечески. Нет матриц f и f_o, есть только матрица Obstacle.
f_z переименнована в Inyensity


Принципиально поменялась одна вещь. Раньше мы считали отношение стороны отверстия к стороне экрана, но это не удобно. Во-первых, на самом деле изображение имеет фиксированное количество пикселей (1920X1080 - Full HD). Во-вторых так будет меньше переменных и вычислений для каждой итерации. Создавать масив нужно фиксированного размера для конечной картины.

Были удалены переменные отвечающие за промежуточные значения поля в точке.
Это сильно повысит производительность